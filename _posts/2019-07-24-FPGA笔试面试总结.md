---
layout:     post
title:      FPGA笔试面试总结
subtitle:   
date:       2019-07-24
author:     yzmb2411
header-img: 
catalog: 	 true
tags:
    - FPGA
    - Verilog 
---
## 1、FPGA开发基本流程

 - 系统规划：系统功能，功能模块划分
 
 - RTL设计：使用Verilog、System Verilog、VHDL进行描述
 
 - 功能仿真：理想情况下的仿真
 
 - 综合、编译、布局布线：FPGA厂商自带工具完成
 
 - 时序仿真：时序分析约束
 
 - 板级验证
 
## 2、什么是同步逻辑和异步逻辑？

&emsp;同步逻辑是时钟之间有固定的因果关系。异步逻辑是各时钟之间没有固定的因果关系。 答案应该与上面问题一致。
  
  〔补充〕：同步时序逻辑电路的特点：各触发器的时钟端全部连接在一起，并接在系统时钟端，只有当时钟脉冲到来时，电路的状态才能改变。改变后的状态将一直保持到下一个时钟脉冲的到来，此时无论外部输入 x 有无变化，状态表中的每个状态都是稳定的。
  
&emsp;异步时序逻辑电路的特点：电路中除可以使用带时钟的触发器外，还可以使用不带时钟的触发器和延迟元件作为存储元件，电路中没有统一的时钟，电路状态的改变由外部输入的变化直接引起。

## 3、时序设计的实质


  电路设计的难点在时序设计，时序设计的实质就是满足每一个触发器的建立/保持时间的要求。
## 4、建立时间与保持时间的概念？

建立时间：触发器在时钟上升沿到来之前，其数据输入端的数据必须保持不变的时间。

保持时间：触发器在时钟上升沿到来之后，其数据输入端的数据必须保持不变的时间。

1、建立/保持时间是D触发器的一个固有属性。

2、在时钟跳变沿到来前、后的一段时间内输入数据要稳定不变，“前”我们称之为建立时间，“后”我们称之为保持时间。

3、触发器的数据输入端必须在建立时间前到达，而且要保持到持续时间以后。

不考虑时钟的skew，D2的建立时间不能大于（时钟周期T - D1数据最迟到达时间T1max+T2max）；保持时间不能大于（D1数据最快到达时间T1min+T2min）；否则D2的数据将进入亚稳态并向后级电路传播
 
5：为什么触发器要满足建立时间和保持时间？
因为触发器内部数据的形成是需要一定的时间的，如果不满足建立和保持时间，触发器将进入亚稳态，进入亚稳态后触发器的输出将不稳定，在0和1之间变化，这时需要经过一个恢复时间，其输出才能稳定，但稳定后的值并不一定是你的输入值。这就是为什么要用两级触发器来同步异步输入信号。这样做可以防止由于异步输入 信号对于本级时钟可能不满足建立保持时间而使本级触发器产生的亚稳态传播到后面逻辑中，导致亚稳态的传播。
（比较容易理解的方式）换个方式理解：需要建立时间是因为触发器的D段像一个锁存器在接受数据，为了稳定的设置前级门的状态需要一段稳定时间；需要保持时间是因为在时钟沿到来之后，触发器要通过反馈来所存状态，从后级门传到前级门需要时间。
6、电路的延时

Tclk1：时钟到寄存器1的时间
Tclk2：时钟到达寄存器2的时间
Tco：寄存器传输延时，即上升沿后数据从输入到输出的时间
Tdata：组合逻辑延时，上个的输出传到下个输入

上图时间分别为TCO,TDATA,TUS
随着时钟频率增加，上升沿下降沿变窄，故最小周期为：
Tmin=Tco+Tdata+Tsu-Tskew
Tskew=Tclk2-Tclk1  最快频率Fmax=1/Tmin
如果要提高时钟频率，可以怎么做
TCO的值是固定的，建立时间也是固定的，所以只能调整Tdata。
1、	关键路径：延时最长的路径；
2、	一个电路所能运行的最高频率取决于次=此路径，所以很关键



建立/保持时间    

	电路的延时



FPGA时序	关键路径


	时钟频率


	流水线设计

建立时间是电路延时的一部分
关键路径是寄存器间最长的延时
关键路径决定最高的时钟频率
流水线设计是提高电路工作频率的方法
7、什么是亚稳态？为什么两级触发器可以防止亚稳态传播？
亚稳态是指触发器无法在某个规定的时间段内到达一个可以确认的状态。使用两级触发器来使异步电路同步化的电路其实叫做“一步同位器”，他只能用来对一位异步信号进行同步。两级触发器可防止亚稳态传播的原理：假设第一级触发器的输入不满足其建立保持时间，它在第一个脉冲沿到来后输出的数据就为亚稳态，那么在下一个脉冲沿到来之前，其输出的亚稳态数据在一段恢复时间后必须稳定下来，而且稳定的数据必须满足第二级触发器的建立时间，如果都满足了，在下一个脉冲沿到来时，第二级触发器将不会出现亚稳态，因为其输入端的数据满足其建立保持时间。同步器有效的条件：第一级触发器进入亚稳态后的恢复时间 + 第二级触发器的建立时间。
更确切地说，输入脉冲宽度必须大于同步时钟周期与第一级触发器所需的保持时间之和。最保险的脉冲宽度是两倍同步时钟周期。 所以，这样的同步电路对于从较慢的时钟域来的异步信号进入较快的时钟域比较有效，对于进入一个较慢的时钟域，则没有作用 。
解决方法：
1 降低系统时钟频率
2 用反应更快的FF
3 引入同步机制，防止亚稳态传播（可以采用前面说的加两级触发器）。
4 改善时钟质量，用边沿变化快速的时钟信号
8、系统最高速度计算（最快时钟频率）和流水线设计思想：
同步电路的速度是指同步系统时钟的速度，同步时钟愈快，电路处理数据的时间间隔越短，电路在单位时间内处理的数据量就愈大。假设Tco是触发器的输入数据 被时钟打入到触发器到数据到达触发器输出端的延时时间；Tdelay是组合逻辑的延时；Tsetup是Ｄ触发器的建立时间。假设数据已被时钟打入D触发 器，那么数据到达第一个触发器的Ｑ输出端需要的延时时间是Tco，经过组合逻辑的延时时间为Tdelay，然后到达第二个触发器的Ｄ端，要希望时钟能在第 二个触发器再次被稳定地打入触发器，则时钟的延迟必须大于Tco＋Tdelay＋Tsetup，也就是说最小的时钟周期Tmin =Tco＋Tdelay＋Tsetup，即最快的时钟频率Fmax =1/Tmin。FPGA开发软件也是通过这种方法来计算系统最高运行速度Fmax。因为Tco和Tsetup是由具体的器件工艺决定的，故设计电路时只 能改变组合逻辑的延迟时间Tdelay，所以说缩短触发器间组合逻辑的延时时间是提高同步电路速度的关键所在。由于一般同步电路都大于一级锁存，而要使电 路稳定工作，时钟周期必须满足最大延时要求。故只有缩短最长延时路径，才能提高电路的工作频率。可以将较大的组合逻辑分解为较小的N块，通过适当的方法平 均分配组合逻辑，然后在中间插入触发器，并和原触发器使用相同的时钟，就可以避免在两个触发器之间出现过大的延时，消除速度瓶颈，这样可以提高电路的工作 频率。这就是所谓"流水线"技术的基本设计思想，即原设计速度受限部分用一个时钟周期实现，采用流水线技术插入触发器后，可用N个时钟周期实现，因此系统 的工作速度可以加快，吞吐量加大。注意，流水线设计会在原数据通路上加入延时，另外硬件面积也会稍有增加。
9、时序约束的概念和基本策略？
时序约束主要包括周期约束，偏移约束，静态时序路径约束三种。通过附加时序约束可以综合布线工具调整映射和布局布线，是设计达到时序要求。
附加时序约束的一般策略是先附加全局约束，然后对快速和慢速例外路径附加专门约束。附加全局约束时，首先定义设计的所有时钟，对各时钟域内的同步元件进行分 组，对分组附加周期约束，然后对FPGA/CPLD输入输出PAD附加偏移约束、对全组合逻辑的PAD TO PAD路径附加约束。附加专门约束时，首先约束分组之间的路径，然后约束快、慢速例外路径和多周期路径，以及其他特殊路径。
10、附加约束的作用？
作用：1：提高设计的工作频率（减少了逻辑和布线延时）；2：获得正确的时序分析报告；（静态时序分析工具以约束作为判断时序是否满足设计要求的标准，因 此要求设计者正确输入约束，以便静态时序分析工具可以正确的输出时序报告）3：指定FPGA/CPLD的电气标准和引脚位置。
11、FPGA设计工程师努力的方向：
SOPC， 高速串行I/O，低功耗，可靠性，可测试性和设计验证流程的优化等方面。随着芯片工艺的提高，芯片容量、集成度都在增加，FPGA设计也朝着高速、高度集 成、低功耗、高可靠性、高可测、可验证性发展。芯片可测、可验证，正在成为复杂设计所必备的条件，尽量在上板之前查出bug，将发现bug的时间提前，这 也是一些公司花大力气设计仿真平台的原因。另外随着单板功能的提高、成本的压力，低功耗也逐渐进入FPGA设计者的考虑范围，完成相同的功能下，考虑如何 能够使芯片的功耗最低，据说altera、xilinx都在根据自己的芯片特点整理如何降低功耗的文档。高速串行IO的应用，也丰富了FPGA的应用范 围，象xilinx的v2pro中的高速链路也逐渐被应用。 总之，学无止境，当掌握一定概念、方法之后，就要开始考虑FPGA其它方面的问题了。
12、对于多位的异步信号如何进行同步？
对以一位的异步信号可以使用“一位同步器进行同步”，而对于多位的异步信号，可以采用如下方法：1：可以采用保持寄存器加握手信号的方法（多数据，控制， 地址）；2：特殊的具体应用电路结构,根据应用的不同而不同 ；3：异步FIFO。（最常用的缓存单元是DPRAM）
13、FPGA和CPLD的区别？
FPGA是可编程ASIC。
ASIC:专用集成电路，它是面向专门用途的电路，专门为一个用户设计和制造的。根据一个用户的特定要求，能以低研制成本，短、交货周期供货的全定制，半定制集成电路。与门阵列等其它ASIC(ApplicaTIon Specific IC)相比，它们又具有设计开发周期短、设计制造成本低、开发工具先进、标准产品无需测试、质量稳定以及可实时在线检验等优点。
CPLD FPGA
内部结构 Product－term Look－up Table
程序存储 内部EEPROM SRAM，外挂EEPROM
资源类型 组合电路资源丰富 触发器资源丰富
集成度 低 高
使用场合 完成控制逻辑 能完成比较复杂的算法
速度 慢 快
其他资源 － PLL、RAM和乘法器等
保密性 可加密 一般不能保密
14、锁存器（latch）和触发器（flip-flop）区别？
电平敏感的存储期间称为锁存器。可分为高电平锁存器和低电平锁存器，用于不同时钟之间的信号同步。
有交叉耦合的门构成的双稳态的存储原件称为触发器。分为上升沿触发和下降沿触发。可以认为是两个不同电平敏感的锁存器串连而成。前一个锁存器决定了触发器的建立时间，后一个锁存器则决定了保持时间。
15、FPGA芯片内部结构
FPGA芯片主要由7部分完成，分别为：可编程输入输出单元、基本可编程逻辑单元、完整的时钟管理、嵌入块式RAM、丰富的布线资源、内嵌的底层功能单元和内嵌专用硬件模块。
FPGA中的基本逻辑单元是CLB模块，一个CLB模块一般包含若干个基本的查找表、寄存器和多路选择器资源，因此FPGA中的逻辑表达式基于LUT的。

15、FPGA芯片内有哪两种存储器资源？
FPGA芯片内有两种存储器资源：一种叫block ram,另一种是由LUT配置成的内部存储器（也就是分布式ram）。Block ram由一定数量固定大小的存储块构成的，使用BLOCK RAM资源不占用额外的逻辑资源，并且速度快。但是使用的时候消耗的BLOCK RAM资源是其块大小的整数倍。CLB单元生成的distribute ram ，CLB是FPGA的基本单元，blockram也是基本单元，但分布ram要由CLB单元生成。由CLB生成分布式ram，消耗逻辑资源。而blockram则固定在fpga内，无论使用与否都存在于那里。当block ram不够用时可以用逻辑资源生成分布式ram。
16、什么是时钟抖动？
时钟抖动是指芯片的某一个给定点上时钟周期发生暂时性变化，也就是说时钟周期在不同的周期上可能加长或缩短。它是一个平均值为0的平均变量。
17、FPGA设计中对时钟的使用？（例如分频等）
FPGA芯片有固定的时钟路由，这些路由能有减少时钟抖动和偏差。需要对时钟进行相位移动或变频的时候，一般不允许对时钟进行逻辑操作，这样不仅会增加时 钟的偏差和抖动，还会使时钟带上毛刺。一般的处理方法是采用FPGA芯片自带的时钟管理器如PLL,DLL或DCM，或者把逻辑转换到触发器的D输入（这 些也是对时钟逻辑操作的替代方案）。
18、FPGA设计中如何实现同步时序电路的延时？
首先说说异步电路的延时实现：异步电路一半是通过加buffer、两级与非门等（我还没用过所以也不是很清楚），但这是不适合同步电路实现延时的。在同步 电路中，对于比较大的和特殊要求的延时，一半通过高速时钟产生计数器，通过计数器来控制延时；对于比较小的延时，可以通过触发器打一拍，不过这样只能延迟 一个时钟周期。
19、FPGA中可以综合实现为RAM/ROM/CAM的三种资源及其注意事项？
三种资源：block ram;触发器（FF），查找表（LUT）；
注意事项：1：在生成RAM等存储单元时，应该首选block ram 资源；其原因有二：第一：使用block ram等资源，可以节约更多的FF和4-LUT等底层可编程单元。使用block ram可以说是“不用白不用”，是最大程度发挥器件效能，节约成本的一种体现；第二：block ram是一种可以配置的硬件结构，其可靠性和速度与用LUT和register构建的存储器更有优势。2：弄清FPGA的硬件结构，合理使用block ram资源；3：分析block ram容量，高效使用block ram资源；4：分布式ram资源（distribute ram）
20、Xilinx中与全局时钟资源和DLL相关的硬件原语：
常用的与全局时钟资源相关的Xilinx器件原语包括：IBUFG,IBUFGDS,BUFG,BUFGP,BUFGCE,BUFGMUX,BUFGDLL,DCM等。关于各个器件原语的解释可以参考《FPGA设计指导准则》p50部分。
21、HDL语言的层次概念？
HDL语言是分层次的、类型的，最常用的层次概念有系统与标准级、功能模块级，行为级，寄存器传输级和门级。
22、查找表的原理与结构？
查找表（look-up-table）简称为LUT，LUT本质上就是一个RAM。目前FPGA中多使用4输入的LUT，所以每一个LUT可以看成一个有 4位地址线的16x1的RAM。 当用户通过原理图或HDL语言描述了一个逻辑电路以后，PLD/FPGA开发软件会自动计算逻辑电路的所有可能的结果，并把结果事先写入RAM,这样，每 输入一个信号进行逻辑运算就等于输入一个地址进行查表，找出地址对应的内容，然后输出即可
23、ic设计前端到后端的流程和eda工具？
设计前端也称逻辑设计，后端设计也称物理设计，两者并没有严格的界限，一般涉及到与工艺有关的设计就是后端设计。
1：规格制定：客户向芯片设计公司提出设计要求。
2：详细设计：芯片设计公司（Fabless）根据客户提出的规格要求，拿出设计解决方案和具体实现架构，划分模块功能。目前架构的验证一般基于 systemC语言，对价后模型的仿真可以使用systemC的仿真工具。例如：CoCentric和Visual Elite等。
3：HDL编码：设计输入工具：ultra ，visual VHDL等
4：仿真验证：modelsim
5：逻辑综合：synplify
6：静态时序分析：synopsys的Prime Time
7：形式验证：Synopsys的Formality.
24、ARM、DSP、FPGA 的技术特点和区别
ARM具有比较强的事务管理功能，可以用来跑界面以及应用程序等，其优势主要体现在控制方面，而DSP主要是用来计算的，比如进行加密解密、调制解调等，优势是强大的数据处理能力和较高的运行速度。FPGA可以用VHDL或verilogHDL来编程，灵活性强，由于能够进行编程、除错、 再编程和重复操作，因此可以充分地进行设计开发和验证。当电路有少量改动时，更能显示出FPGA的优势，其现场编程能力可以延长产品在市场上的寿命，而这 种能力可以用来进行系统升级或除错。
FPGA 、DSP、 ARM群芳争艳
   话说这三者要是放在一块，可谓是三足鼎立。各自的特点在各自的领域大有身手。ARM有丰富的外设接口，精于控制，且基于ARM架构开发的芯片具有较低的功耗，使得续航时间大大延长（移动端）；DSP有优化的超强运算能力，专于运算处理；而FPGA则极其灵活，加之具备硬件独有的并行结构，使其在图像处理，接口协议等方面应用广泛。
    第一，在编程语言方面，FPGA利用VHDL或Verilog语言进行编程，相比C/C++语言编程来说，在代码灵活度和开发效率上还有欠缺。
    第二，从资源配置来看，ARM、DSP等处理器集成了运算单元、存储单元及大量的总线接口，只需正确配置各个寄存器参数后即可使总线接口工作在相应的模式下。而FPGA内部有大量的逻辑资源，总线接口需要自拟，会占用大量的开发时间。
    第三，从工作频率来看，ARM、DSP等处理器采用的是成熟的内核结构，具有较好的时序特性，其最高频率通常为600MHz ~1.25GHz。TI等芯片厂商采用多核的设计方式，设计了具有8核DSP、8核ARM的处理器，每个核心的最大工作频率可达到1.25GHz。FPGA中不同设计系统工作频率不一样，良好的时序约束可以提高设计的最高设计频率。
    第四，从算法设计来看，ARM、DSP等处理器集成了加法器、乘法器等运算单元，尤其是在DSP中，可以在一个周期内进行8x8甚至16x16的乘法运算，同时支持浮点数运算。而FPGA不擅长浮点数运算，一些简单的加法可能也会对时序产生一定的影响，进而影响最高频率。
        
25、Verilog基础知识（`define、parameter、localparam三者的区别及举例）
1、概述
    `define：作用 -> 常用于定义常量可以跨模块、跨文件;
                            范围 -> 整个工程;
     parameter：     作用 -> 常用于模块间参数传递;
                           范围 -> 本module内有效的定义;
     localparam       作用 -> 常用于状态机的参数定义;
                           范围 -> 本module内有效的定义，不可用于参数传递;

在顶层文件中例化mem module时可以这样做:
  mem #(.DATA_WIDTH(DATA_WIDTH), .ADDR_WIDTH(6))
   i_mem (
    .clka (adc_clk),
    .wea (adc_wr),
    .addra (adc_waddr),
    .dina (adc_wdata),
    .clkb (dma_clk),
    .addrb (dma_raddr),
    .doutb (dma_rdata_s));

也可以将底层模块的parameter参数置于module端口声明之前，例如:
`timescale 1ns/100ps
module mem 
          #(parameter DATA_WIDTH = 16
            parameter ADDR_WIDTH =  5)
           (  
            input    clka,
            input    wea,
            input   [AW:0]  addra,
            input   [DW:0]  dina,
            input           clkb,
            input   [AW:0]  addrb,
            output  [DW:0]  doutb
           ); 

  localparam      DW = DATA_WIDTH - 1;
  localparam      AW = ADDR_WIDTH - 1;

  reg     [DW:0]  m_ram[0:((2**ADDR_WIDTH)-1)];
  reg     [DW:0]  doutb;

  always @(posedge clka) begin
    if (wea == 1'b1) begin
      m_ram[addra] <= dina;
    end
  end

  always @(posedge clkb) begin
    doutb <= m_ram[addrb];
  end

endmodule

26、DCM、PLL、PMCD、MMCM的区别与联系？
由于XIlinx FPGA分为很多器件系列，而且不同系列的FPGA包含的时钟管理资源还不一样，于是经常遇到DCM、PLL、PMCM、MMCM这些专用术语，出现的比较混乱，让人很是迷惑。
例如在Spartan_6系列的FPGA中，我曾看到它的时钟管理资源是时钟管理器（CMT），时钟管理器（CMT）中又包含一个PLL和两个DCM，且这两者的作用还不同。
如下图，为Spartan_6系列FPGA的CMT片内布局图，可见每一个CMT包含一个PLL和两个DCM。







数字时钟管理器（DCM）是一种用于管理时钟架构并有助于时钟信号成形和操控的模块。DCM内含一个延迟锁相环（DLL），可根据输入时钟信号，去除DCM输出时钟信号的歪斜，从而避免时钟分配延迟。DLL 内含一个延迟元件和控制逻辑链路。延迟元件的输出是输入时钟延迟所得。延迟时间取决于延迟元件在延迟链路中的位置。这种延迟体现为针对原始时钟的相位改变或相移，这就是所谓的“数字相移”。DCM适用于实现延迟锁相环（DLL）、数字频率综合器、数字移相器或数字频谱扩展器。 DCM还是镜像、发送或再缓冲时钟信号的理想选择。

DCM功能结构图
(1)延时锁相环（DLL）。
DLL 延时锁相环可以根据输入时钟去除DCM 的输出时钟歪斜，以完全消除时钟分布延迟。其原理是将时钟输入（CLKIN）与一个反馈输入（CLKFB）进行比较，然后控制延迟线选择器，通过在DLL 路径中加入合适的延迟直到CLKIN 与CLKFB 重合。
DLL 输入时钟是CLKIN 和CLKFB，输出时钟信号是CLK0、CLK90、CLK180、CLK270、CLK2X、CLK2X180 和CLKDV。
(2) 数字频率综合器（DFS）。
DFS有两个用户寄存器，用来设置相对于输入时钟（CLKIN）倍频（CLKFX_MULTIPLY）和分频（CLKFX_DIVID）系数。DFS可以单独使用，还可以和DLL一起配合使用；如果DFS不和DLL一起使用，CLKIN和DFS输出之间没有对应的相位关系。DFS的输出为CLKFX和CLKFX180。
(3) 相移单元（PS）。
相移单元PS的输入信号有PSINCDEC、PSEN和PSCLK，输出信号为PSDONE和STATUS[0]。相移模式包括固定相移和可变相移。
固定相移是指DCM的9个时钟的相位输出，通常是输入时钟周期的若干分之一，固定相移值在设计中设定并在FPGA配置时载入FPGA。
除了固定相移，PS还支持可变相移，根据系统要求，通过数字接口（PSINCDEC、PSEN和PSCLK）动态改变相移。每次动态改变的相移值为DCM_DELAY_STEP，DCM_DELAY_STEP对应的范围可参考《Spartan-6数据手册》。
(4) 状态逻辑。
状态逻辑反映DCM的状态，对应两个输出信号LOCKED和STATUS[0]。
一般来说，DLL与PLL类似。但与PLL不同的是DLL不含压控振荡器（VCO）。
PLL会一直存储相位和频率信息，而DLL只存储相位信息。因此，DLL略比PLL稳定。DLL和PLL这两种类型都可以使用模拟和数字技术设计，或者混合两种技术设计。但赛灵思器件中的DCM采用全数字化设计。
有时设计可能需要一个更高的时钟频率来运行FPGA上的逻辑。但是，只有低频率输出的时钟源可以用。此时可以使用DCM将时钟源的输入时钟信号相乘，生成高频率时钟信号。与此类似，可以将来自高频率时钟源的输入时钟信号相除，生成低频率时钟信号。这种技术称为“数字频率综合”。
建立时钟的镜像需要将时钟信号送出FPGA器件，然后又将它接收回来。可以使用这种方法为多种器件的板级时钟信号去歪斜。DCM能够把时钟信号从FPGA发送到另一个器件。这是因为FPGA的输入时钟信号不能直接路由到输出引脚，没有这样的路由路径可用。如果仅需要发送时钟信号，那么使用DCM将时钟信号发送到输出引脚，可以确保信号的保真度。另外也可选择在时钟信号发送之前，将DCM输出连接到ODDR触发器。当然也可以选择不使用DCM，仅使用ODDR 来发送时钟信号。往往时钟驱动器需要将时钟信号驱动到设计的多个组件。这会增大时钟驱动器的负荷，导致出现时钟歪斜及其它问题。在这种情况下，需要采用时钟缓冲来平衡负载。
时钟可以连接到FPGA上的一系列逻辑块上。为确保时钟信号在远离时钟源的寄存器上有合适的上升和下降时间（从而将输入输出时延控制在允许的范围内），需要在时钟驱动器和负载之间插入时钟缓冲器。DCM可用作时钟输入引脚和逻辑块之间的时钟缓冲器。
最后，还可以使用DCM将输入时钟信号转换为差分I/O标准信号。例如，DCM可以将输入的LVTTL时钟信号转换为LVDS时钟信号发送出去。
锁相环（PLL）主要用于频率综合。使用一个 PLL 可以从一个输入时钟信号生成多个时钟
信号。结合 DCM 使用，还可以用作抖动滤波器。 Spartan-6 有专门的“DCM 到 PLL” 和“PLL到 DCM” 走线。 Spartan-6 的 PLL 输出是非扩频的。如果设计使用多个不同时钟，都可以用PLL 替代 DCM。 PLL 时钟输出具有宽范的配置范围，而 DCM 的输出是预定的，不可配置。PLL 和 DCM 的选择还是取决于设计的要求。不过如果相移是必需的，就应该明确地选择 DCM。
PLL是为支持时钟网络去歪斜SKEW、频率合成和减少抖动而设计的混合信号模块
PLL内部的功能框图如下图所示：

相位匹配时钟分频器（PMCD）可用于实现相位匹配分配时钟或相位匹配延迟时钟。
锁相环（PLL）和混合模式时钟管理器（MMCM）处理的工作有许多是相同的，比如频率综合、内外部时钟抖动滤波、时钟去歪斜等。这两种资源也可用于镜像、发送或再缓冲时钟信号。
27、竞争与冒险
电路中有一个非门和一个与门，本来在理想情况下F的输出应该是一直稳定的0输出，但是实际上每个门电路从输入到输出是一定会有时间延迟的，这个时间通常叫做电路的开关延迟。而且制作工艺、门的种类甚至制造时微小的工艺偏差，都会引起这个开关延迟时间的变化。
实际上如果算上逻辑门的延迟的话，那么F最后就会产生毛刺。信号由于经由不同路径传输达到某一汇合点的时间有先有后的现象，就称之为竞争，由于竞争现象所引起的电路输出发生瞬间错误的现象，就称之为冒险，FPGA设计中最简单的避免方法是尽量使用时序逻辑同步输入输出。
加滤波电容，消除毛刺的影响
加选通信号，避开毛刺
增加冗余项，消除逻辑冒险。
28、用D触发器带同步高置数和异步高复位端的二分频电路，画出逻辑电路






reg Q;
always @(posedge clk or posedge rst)begin
if(rst == 1'b1)
Q <= 1'b0;
else if(set == 1'b1)
Q <= 1'b1;
else
Q <= ~Q;
end

29、IC设计中同步复位与异步复位的区别？
同步复位在时钟沿变化时，完成复位动作。异步复位不管时钟，只要复位信号满足条件，就完成复位动作。异步复位对复位信号要求比较高，不能有毛刺，如果其与时钟关系不确定，也可能出现亚稳态。
30、MOORE 与 MEELEY状态机的特征？
    Moore 状态机的输出仅与当前状态值有关, 且只在时钟边沿到来时才会有状态变化。
    Mealy 状态机的输出不仅与当前状态值有关, 而且与当前输入值有关。
31、多时域设计中,如何处理信号跨时域？
不同的时钟域之间信号通信时需要进行同步处理，这样可以防止新时钟域中第一级触发器的亚稳态信号对下级逻辑造成影响。信号跨时钟域同步：当单个信号跨时钟域时，可以采用两级触发器来同步；数据或地址总线跨时钟域时可以采用异步FIFO来实现时钟同步；第三种方法就是采用握手信号。
32、查找表的原理和结构
查找表（look-up-table）简称为LUT，LUT本质上就是一个RAM。目前FPGA中多使用4输入的LUT，所以每一个LUT可以看成一个有 4位地址线的16x1的RAM。当用户通过原理图或HDL语言描述了一个逻辑电路以后，CPLD/FPGA开发软件会自动计算逻辑电路的所有可能的结果，并把结果事先写入RAM,这样，每输入一个信号进行逻辑运算就等于输入一个地址进行查表，找出地址对应的内容，然后输出即可。
33、寄生效应在IC设计中怎样加以克服和利用（这是我的理解，原题好像是说，IC设计过程中将寄生效应的怎样反馈影响设计师的设计方案）？
所谓寄生效应就是那些溜进你的PCB并在电路中大施破坏、令人头痛、原因不明的小故障。它们就是渗入高速电路中隐藏的寄生电容和寄生电感。其中包括由封装引脚和印制线过长形成的寄生电感；焊盘到地、焊盘到电源平面和焊盘到印制线之间形成的寄生电容；通孔之间的相互影响，以及许多其它可能的寄生效应。
理想状态下，导线是没有电阻，电容和电感的。而在实际中，导线用到了金属铜，它有一定的电阻率，如果导线足够长，积累的电阻也相当可观。两条平行的导线，如 果互相之间有电压差异，就相当于形成了一个平行板电容器（你想象一下）。通电的导线周围会形成磁场（特别是电流变化时），磁场会产生感生电场，会对电子的 移动产生影响，可以说每条实际的导线包括元器件的管脚都会产生感生电动势，这也就是寄生电感。
在直流或者低频情况下，这种寄生效应看不太出来。而在交流特别是高频交流条件下，影响就非常巨大了。根据复阻抗公式，电容、电感会在交流情况下会对电流的移动产生巨大阻碍，也就可以折算成阻抗。这种寄生效应很难克服，也难摸到。只能通过优化线路，尽量使用管脚短的SMT元器件来减少其影响，要完全消除是不可能的。
34、用flip-flop和logic-gate设计一个1位加法器，输入carryin和current-stage，输出carryout和next-stage？
carryout=carryin*current-stage；与门
next-stage=carryin’*current-stage+carryin*current-stage’;与门，非门，或门（或者异或门）
module(clk,current-stage,carryin,next-stage,carryout);
inputclk, current-stage,carryin;
outputnext-stage,carryout;
always@(posedgeclk)
carryout<=carryin&current-stage;
nextstage<=
35、设计一个自动饮料售卖机，饮料10分钱，硬币有5分和10分两种，并考虑找零
1.画出fsm（有限状态机）
2.用verilog编程，语法要符合FPGA设计的要求
3.设计工程中可使用的工具及设计大致过程？

设计过程：
1、首先确定输入输出，A=1表示投入10分，B=1表示投入5分，Y=1表示弹出饮料，Z=1表示找零。
2、确定电路的状态，S0表示没有进行投币，S1表示已经有5分硬币。
3、画出状态转移图。


module sell(clk,rst,a,b,y,z);
input clk,rst,a,b;
output y,z;
parameter s0=0,s1=1;
reg state,next_state;
always@(posedge clk)
begin
if(!rst)
state<=s0;
else
state<=next_state;
end
always@(a or b or cstate)
begin
y=0;z=0;
case(state)
s0: if(a==1&&b==0)next_state=s1;
else if(a==0&&b==1)
begin
next_state=s0;y=1;
end
else
next_state=s0;
s1: if(a==1&&b==0)
begin
next_state=s0;y=1;
end
else if(a==0&&b==1)
begin
next_state=s0;y=1;z=1;
end
else
next_state=s0;
default: next_state=s0;
endcase
end
endmodule
扩展：设计一个自动售饮料机的逻辑电路。它的投币口每次只能投入一枚五角或一元的硬币。投入一元五角硬币后给出饮料；投入两元硬币时给出饮料并找回五角。
1、确定输入输出，投入一元硬币A=1，投入五角硬币B=1，给出饮料Y=1，找回五角Z=1；
2、确定电路的状态数，投币前初始状态为S0，投入五角硬币为S1，投入一元硬币为S2。画出转该转移图，根据状态转移图可以写成Verilog代码。
36、什么是"线与"逻辑,要实现它,在硬件特性上有什么具体要求?
线与逻辑是两个输出信号相连可以实现与的功能。在硬件上,要用oc门来实现,由于不用oc门可能使灌电流过大,而烧坏逻辑门. 同时在输出端口应加一个上拉电阻。oc门就是集电极开路门。od门是漏极开路门。
37、什么是竞争与冒险现象?怎样判断?如何消除?、
在组合电路中，某一输入变量经过不同途径传输后，到达电路中某一汇合点的时间有先有后，这种现象称竞争；由于竞争而使电路输出发生瞬时错误的现象叫做冒险。（也就是由于竞争产生的毛刺叫做冒险）。
判断方法：代数法（如果布尔式中有相反的信号则可能产生竞争和冒险现象）；卡诺图：有两个相切的卡诺圈并且相切处没有被其他卡诺圈包围，就有可能出现竞争冒险；实验法：示波器观测；
解决方法：1：加滤波电容，消除毛刺的影响；2：加选通信号，避开毛刺；3：增加冗余项消除逻辑冒险。
门电路两个输入信号同时向相反的逻辑电平跳变称为竞争；
由于竞争而在电路的输出端可能产生尖峰脉冲的现象称为竞争冒险。
如果逻辑函数在一定条件下可以化简成Y=A+A’或Y=AA’则可以判断存在竞争冒险现象（只是一个变量变化的情况）。
消除方法，接入滤波电容，引入选通脉冲，增加冗余逻辑
38、你知道那些常用逻辑电平?TTL与COMS电平可以直接互连吗？
常用逻辑电平：TTL、CMOS、LVTTL、LVCMOS、ECL（Emitter Coupled Logic）、PECL（Pseudo/Positive Emitter Coupled Logic）、LVDS（Low Voltage Differential Signaling）、GTL（Gunning Transceiver Logic）、BTL（Backplane Transceiver Logic）、ETL（enhanced transceiver logic）、GTLP（Gunning Transceiver Logic Plus）；RS232、RS422、RS485（12V，5V，3.3V）；
也有一种答案是：常用逻辑电平：12V，5V，3.3V。
TTL和CMOS 不可以直接互连，由于TTL是在0.3-3.6V之间，而CMOS则是有在12V的有在5V的。CMOS输出接到TTL是可以直接互连。TTL接到 CMOS需要在输出端口加一上拉电阻接到5V或者12V。
用CMOS可直接驱动TTL;加上拉电阻后,TTL可驱动CMOS.
上拉电阻用途：
1、当TTL电路驱动COMS电路时，如果TTL电路输出的高电平低于COMS电路的最低高电平（一般为3.5V），这时就需要在TTL的输出端接上拉电阻，以提高输出高电平的值。
2、OC门电路必须加上拉电阻，以提高输出的高电平值。
3、为加大输出引脚的驱动能力，有的单片机管脚上也常使用上拉电阻。
4、在COMS芯片上，为了防止静电造成损坏，不用的管脚不能悬空，一般接上拉电阻产生降低输入阻抗，提供泄荷通路。
5、芯片的管脚加上拉电阻来提高输出电平，从而提高芯片输入信号的噪声容限增强抗干扰能力。
6、提高总线的抗电磁干扰能力。管脚悬空就比较容易接受外界的电磁干扰。
7、长线传输中电阻不匹配容易引起反射波干扰，加上下拉电阻是电阻匹配，有效的抑制反射波干扰。
上拉电阻阻值的选择原则包括:
1、从节约功耗及芯片的灌电流能力考虑应当足够大；电阻大，电流小。
2、从确保足够的驱动电流考虑应当足够小；电阻小，电流大。
3、对于高速电路，过大的上拉电阻可能边沿变平缓。综合考虑以上三点,通常在1k到10k之间选取。对下拉电阻也有类似道理。
OC门电路必须加上拉电阻，以提高输出的高电平值。
OC门电路要输出“1”时才需要加上拉电阻不加根本就没有高电平
在有时我们用OC门作驱动（例如控制一个 LED）灌电流工作时就可以不加上拉电阻
总之加上拉电阻能够提高驱动能力。
39、说说静态、动态时序模拟的优缺点？
静态时序分析是采用穷尽分析方法来提取出整个电路存在的所有时序路径， 计算信号在这些路径上的传播延时，检查信号的建立和保持时间是否满足时序要求，通过对最大路径延时和最小路径延时的分析，找出违背时序约束的错误。它不需 要输入向量就能穷尽所有的路径，且运行速度很快、占用内存较少，不仅可以对芯片设计进行全面的时序功能检查，而且还可利用时序分析的结果来优化设计，因此 静态时序分析已经越来越多地被用到数字集成电路设计的验证中。
动态时序模拟就是通常的仿真，因为不可能产生完备的测试向量，覆盖门级网表中的每一条路径。因此在动态时序分析中，无法暴露一些路径上可能存在的时序问题；
40、为什么一个标准的倒相器中P管的宽长比要比N管的宽长比大?
和载流子有关，P管是空穴导电，N管是电子导电，电子的迁移率大于空穴，同样的电场下，N管的电流大于P管，因此要增大P管的宽长比，使之对称，这样才能使得两者上升时间下降时间相等、高低电平的噪声容限一样、充电放电的时间相等。
41、用mos管搭出一个二输入与非门？
<数字电子技术基础（第五版）> 92页
与非门：上并下串 或非门：上串下并

42、画出NOT,NAND,NOR的符号,真值表,还有transistor level（晶体管）的电路？
<数字电子技术基础（第五版）> 117页—134页
43、画出CMOS的图,画出tow-to-one muxgate.？
Y=SA+S’B 利用与非门和反相器，进行变换后Y=((SA)’*(S’A)’)’，三个与非门，一个反相器。也可以用传输门来实现数据选择器或者是异或门。


